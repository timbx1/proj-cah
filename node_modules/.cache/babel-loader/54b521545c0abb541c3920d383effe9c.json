{"ast":null,"code":"import _slicedToArray from\"D:/Webprog/proj-cah/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{Component,useState,useEffect}from'react';import axios from'axios';import config from'./config.json';import{Status}from'./Status';import{Hilfe}from'./Hilfe';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function JoinedGame(props){var playerData=props.pData;var gameid=props.gId;var _useState=useState(),_useState2=_slicedToArray(_useState,2),players=_useState2[0],setPlayers=_useState2[1];var _useState3=useState(\"Refresh\"),_useState4=_slicedToArray(_useState3,2),buttonRefresh=_useState4[0],setRefresh=_useState4[1];useEffect(function(){getGameData();},[]);function goToGame(){props.changeUi(2,playerData,gameid);}function startGame(){console.log(\"start\");var Jstring='{\"player\":'+playerData.id+',\"action\":\"start\"}';var msg=JSON.parse(Jstring);axios.patch(config.preUrl+'/games/'+gameid+'/'+playerData.id,msg).then(function(response){goToGame();});}function checkIfRunning(game,index){axios.get(config.preUrl+'/games/').then(function(response){if(!response.data.games[index].running){setTimeout(checkIfRunning(game,index),5000);}else{goToGame();}});}function showPlayers(gameData){var index=0;for(var i=0;i<gameData.length;i++){if(gameData[i].id==gameid){index=i;}}var players=gameData[index].players;var pList=[];pList.push(/*#__PURE__*/_jsx(\"p\",{children:\" \"},\"p1\"));pList.push(players.map(function(user){return/*#__PURE__*/_jsxs(\"div\",{children:[\"|  \",user.name,\" \"]},user.id);}));if(gameData[index].owner.id==playerData.id){pList.push(/*#__PURE__*/_jsx(\"p\",{children:\" \"},\"p2\"));pList.push(/*#__PURE__*/_jsx(\"button\",{onClick:startGame,children:\"START GAME\"},\"onlyowner\"));setPlayers(pList);}else{pList.push(/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:\"Wait for owner to Start Game\"},\"p3\"));setPlayers(pList);checkIfRunning(gameData[index],index);}}function getGameData(){setRefresh(\"Refresh\");axios.get(config.preUrl+'/games/').then(function(response){console.log(response.data.games);showPlayers(response.data.games);});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"script\",{type:\"text/javascript\",children:\"document.getElementById(\\\"reload\\\").click();\"}),/*#__PURE__*/_jsx(\"label\",{children:\"Players: \"}),/*#__PURE__*/_jsx(\"button\",{onClick:getGameData,id:\"reload\",children:buttonRefresh}),/*#__PURE__*/_jsx(Hilfe,{}),/*#__PURE__*/_jsx(Status,{gId:gameid}),/*#__PURE__*/_jsx(\"div\",{children:players})]});}export default JoinedGame;","map":{"version":3,"names":["React","Component","useState","useEffect","axios","config","Status","Hilfe","JoinedGame","props","playerData","pData","gameid","gId","players","setPlayers","buttonRefresh","setRefresh","getGameData","goToGame","changeUi","startGame","console","log","Jstring","id","msg","JSON","parse","patch","preUrl","then","response","checkIfRunning","game","index","get","data","games","running","setTimeout","showPlayers","gameData","i","length","pList","push","map","user","name","owner","color"],"sources":["D:/Webprog/proj-cah/src/JoinedGame.js"],"sourcesContent":["import React, { Component, useState, useEffect } from 'react'\r\nimport axios from 'axios'\r\nimport config from './config.json'\r\nimport { Status } from './Status'\r\nimport { Hilfe } from './Hilfe'\r\n\r\nfunction JoinedGame(props) {\r\n  const playerData = props.pData\r\n  const gameid = props.gId\r\n  const [players , setPlayers] = useState()\r\n  const [buttonRefresh , setRefresh] = useState(\"Refresh\")\r\n\r\n  useEffect(()=>{\r\n    getGameData()\r\n  },[])\r\n\r\n  function goToGame(){\r\n    props.changeUi(2,playerData,gameid)\r\n  }\r\n\r\n  function startGame (){\r\n    console.log(\"start\")\r\n    let Jstring = '{\"player\":'+playerData.id+',\"action\":\"start\"}' \r\n    let msg = JSON.parse(Jstring)\r\n    axios.patch(config.preUrl+'/games/'+gameid+'/'+playerData.id,msg).then(response => {\r\n      goToGame()\r\n    })\r\n  }\r\n  function checkIfRunning (game, index){\r\n    axios.get(config.preUrl+'/games/').then(response => {\r\n      \r\n      if(!response.data.games[index].running){\r\n        setTimeout(checkIfRunning(game ,index), 5000) \r\n      }\r\n      else{\r\n        goToGame()\r\n      }\r\n      \r\n    }) \r\n    \r\n  }\r\n\r\n\r\n  function showPlayers(gameData){\r\n    \r\n  \r\n    var index = 0;\r\n    for(let i = 0; i < gameData.length; i++){\r\n      if (gameData[i].id == gameid){\r\n        index = i\r\n      }\r\n    }\r\n    var players = gameData[index].players\r\n    var pList = []\r\n    pList.push(<p key={\"p1\"}> </p>)\r\n    pList.push(players.map((user) => (<div key={user.id}>|  {user.name} </div>)))\r\n\r\n    if (gameData[index].owner.id == playerData.id){\r\n      pList.push(<p key={\"p2\"}> </p>)\r\n      pList.push(<button key={\"onlyowner\"} onClick={startGame}>START GAME</button>)\r\n      setPlayers(pList)\r\n    }\r\n    else{\r\n      pList.push(<p key={\"p3\"} style={{color:'red'}}>Wait for owner to Start Game</p>)\r\n      setPlayers(pList)\r\n      checkIfRunning(gameData[index],index)\r\n    }\r\n\r\n    \r\n    \r\n  }\r\n\r\n\r\n\r\n  function getGameData (){\r\n    setRefresh(\"Refresh\")\r\n    axios.get(config.preUrl+'/games/').then(response => {\r\n      console.log(response.data.games)\r\n      showPlayers(response.data.games)\r\n      \r\n    })\r\n\r\n  }\r\n  \r\n  \r\n  return (\r\n    <div>\r\n        <script type=\"text/javascript\">document.getElementById(\"reload\").click();</script>\r\n        <label>Players: </label>\r\n        <button onClick={getGameData} id =\"reload\">{buttonRefresh}</button>\r\n        <Hilfe/>\r\n        <Status gId = {gameid} />\r\n        <div>{players}</div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default JoinedGame"],"mappings":"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"},"metadata":{},"sourceType":"module"}